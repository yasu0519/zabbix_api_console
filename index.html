<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>zabbix api console</title>
<meta charset="utf-8">
<meta name="description" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="./index.css">
</head>
<body>
    <h1>zabbix api console</h1>
    <div>
        <p><label for="url">api url:</label><input type="text" id="url"></p>
        <p>
            <label for="user">user:</label><input type="text" id="user">
            <label for="password">password:</label><input type="password" id="password">
            <label for="method">method:</label><input type="text" id="method">
        </p>
        <p>
            <span>params:</span><br><textarea id="params" rows="10"></textarea>
        </p>
        <button id="get">get</button>
        <div class="result">
            <div>request:</div>
            <textarea id="request" rows="2" readonly></textarea>
            <div>response:</div>
            <textarea id="response" rows="15" readonly></textarea>
        </div>
    </div>
</body>
<script src="./api.js"></script>
<script>
    //  default input
    document.getElementById('url').value = "http://127.0.0.1/api_jsonrpc.php";
    document.getElementById('user').value = "Admin";
    document.getElementById('password').value = "zabbix";
    document.getElementById('method').value = "template.get";
    document.getElementById('params').value = JSON.stringify({
        "output": "extend",
        "filter": {
            "host": [
                "Template OS Linux",
                "Template OS Windows"
            ]
        }
    });


    document.getElementById('get').addEventListener("click", function () {
        let url = document.getElementById('url').value;
        let user = document.getElementById('user').value;
        let password = document.getElementById('password').value;
        var method = document.getElementById('method').value;
        var params = JSON.parse(document.getElementById('params').value);
        document.getElementById('request').value = JSON.stringify({
            "jsonrpc": "2.0",
            "method": method,
            "params": params,
            "id": "*",
            "auth": "********"
        });
        document.getElementById('response').value = "..............";
        document.getElementById('response').value = JSON.stringify(requestZabbixAPI(url, user, password, method, params));
    }, false);
</script>
</html>